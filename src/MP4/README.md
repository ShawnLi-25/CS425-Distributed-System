# MP4 Maple Juice Parallel Computing Framework


## How to run Demo 

### Simply `go run main.go` , run the following commands
1. `maple`: Run Maple Task
2. `Juice`: Run Juice Task
3. `join`:  Join the group 
4. `leave`: Leave current group
5. `ID`: Show local ID at current group
6. `mlist`: Show current membership list of the group
7. `put`: localfilename sdfsfilename: Write(Insert or Update) localfilename distributedly
8. `get`ï¼š sdfsfilename localfilename: Fetches sdfsfilename to local 
9. `delete`: sdfsfilename: Delete all replicas of sdfsfilename
10. `ls`: sdfsfilename: List all VMs who save the file sdfsfilename
11. `store`: Show all sdfs files stored in this VM

## Terms
* **<maple_exe>** Executable file (e.g. wordCountMaple/webLinkJuice)
* **<num_maples>** Client-designated worker number (if available number is less than N, occupy all; otherwise only occupy N nodes)
* **<sdfs_intermediate_filename_prefix>** Intermediate file generated by MapleTask, i.e. File with (key,value) pairs
* **<sdfs_src_directory>** Source File Directory (could be up to 100Ms)

## Data Structure && Message Type

+ Client: 
	Addr string
	rpcClient *rpc.Client

+ Namenode: 
	Filemap map[string]*FileMetadata  		//Key:sdfsFilename  Value:Pointer of metadata
	Nodemap map[string][]string 	  		//Key:NodeID        Value:sdfs FileList
	Cachemap map[string][]string      		//Key:NodeID        Value: cache FileList
	Workingmap map[string]*WorkingNodeInfo  //Key: NodeID		Value: Pointer to Task Metadata
	
+ FileMetadata 
	DatanodeList []string // All the VMs who store this sdfsfile
	LastWrtTime  time.Time // Last put time of this sdfsfile  

+ Datanode:
	NamenodeID string   //NodeID, not Address
	FileList   []string //list of sdfsfile

+ Block: 	Idx int
	Size int
	Content []byte

+ FileInfo: 
	Filename string
	Filesize int
	Totalblock int





